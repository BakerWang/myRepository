<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.runlion.shop.dao.BspProductskusMapper">
	<resultMap id="BaseResultMap" type="com.runlion.shop.entity.BspProductskus">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		<id column="recordid" property="recordid" jdbcType="INTEGER" />
		<result column="skugid" property="skugid" jdbcType="INTEGER" />
		<result column="pid" property="pid" jdbcType="INTEGER" />
		<result column="attrid" property="attrid" jdbcType="SMALLINT" />
		<result column="attrvalueid" property="attrvalueid" jdbcType="INTEGER" />
		<result column="inputvalue" property="inputvalue" jdbcType="VARCHAR" />
	</resultMap>

	<resultMap id="skumap" type="com.runlion.shop.entity.BspProductskusRTM">

		<id column="recordid" property="recordid" jdbcType="INTEGER" />
		<result column="skugid" property="skugid" jdbcType="INTEGER" />
		<result column="pid" property="pid" jdbcType="INTEGER" />
		<result column="attrid" property="attrid" jdbcType="SMALLINT" />
		<result column="attrvalueid" property="attrvalueid" jdbcType="INTEGER" />
		<result column="inputvalue" property="inputvalue" jdbcType="VARCHAR" />

		<result column="attrvalue" property="attrvalue" jdbcType="VARCHAR" />
		<result column="isinput" property="isinput" jdbcType="VARCHAR" />
		<result column="attrname" property="attrname" jdbcType="VARCHAR" />
		<result column="attrshowtype" property="attrshowtype" jdbcType="VARCHAR" />
		<result column="showimg" property="showimg" jdbcType="VARCHAR" />



	</resultMap>




	<sql id="Example_Where_Clause">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		<where>
			<foreach collection="oredCriteria" item="criteria" separator="or">
				<if test="criteria.valid">
					<trim prefix="(" suffix=")" prefixOverrides="and">
						<foreach collection="criteria.criteria" item="criterion">
							<choose>
								<when test="criterion.noValue">
									and ${criterion.condition}
								</when>
								<when test="criterion.singleValue">
									and ${criterion.condition} #{criterion.value}
								</when>
								<when test="criterion.betweenValue">
									and ${criterion.condition} #{criterion.value}
									and
									#{criterion.secondValue}
								</when>
								<when test="criterion.listValue">
									and ${criterion.condition}
									<foreach collection="criterion.value" item="listItem"
										open="(" close=")" separator=",">
										#{listItem}
									</foreach>
								</when>
							</choose>
						</foreach>
					</trim>
				</if>
			</foreach>
		</where>
	</sql>
	<sql id="Update_By_Example_Where_Clause">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		<where>
			<foreach collection="example.oredCriteria" item="criteria"
				separator="or">
				<if test="criteria.valid">
					<trim prefix="(" suffix=")" prefixOverrides="and">
						<foreach collection="criteria.criteria" item="criterion">
							<choose>
								<when test="criterion.noValue">
									and ${criterion.condition}
								</when>
								<when test="criterion.singleValue">
									and ${criterion.condition} #{criterion.value}
								</when>
								<when test="criterion.betweenValue">
									and ${criterion.condition} #{criterion.value}
									and
									#{criterion.secondValue}
								</when>
								<when test="criterion.listValue">
									and ${criterion.condition}
									<foreach collection="criterion.value" item="listItem"
										open="(" close=")" separator=",">
										#{listItem}
									</foreach>
								</when>
							</choose>
						</foreach>
					</trim>
				</if>
			</foreach>
		</where>
	</sql>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		recordid, skugid, pid, attrid, attrvalueid, inputvalue
	</sql>
	<select id="selectByExample" resultMap="BaseResultMap"
		parameterType="com.runlion.shop.entity.BspProductskusExample">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		select
		<if test="distinct">
			distinct
		</if>
		<include refid="Base_Column_List" />
		from bsp_productskus
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
		<if test="orderByClause != null">
			order by ${orderByClause}
		</if>
	</select>



	<select id="getProductSku" resultMap="skumap" parameterType="java.lang.Integer">

		SELECT a.*, c.attrvalue, c.attrname FROM bsp_productskus a,
		bsp_products b, bsp_attributevalues c where a.skugid = b.skugid
		and
		b.pid = #{pid,jdbcType=INTEGER}
		and a.attrvalueid = c.attrvalueid		
		and exists(select 1 from bsp_products d where d.pid = a.pid and d.state
		= 0)	
		order by attrid;
	</select>
	
	<select id="getProductSkuForPreview" resultMap="skumap" parameterType="java.lang.Integer">
		SELECT a.*, c.attrvalue, c.attrname FROM bsp_productskus a,
		bsp_products b, bsp_attributevalues c where a.skugid = b.skugid
		and
		b.pid = #{pid,jdbcType=INTEGER}
		and a.attrvalueid = c.attrvalueid					
		order by attrid;
	</select>
	
	
	

	<select id="getProductSkuListByGroup" resultMap="skumap"
		parameterType="java.lang.Integer">
		SELECT distinct a.attrid, a.attrvalueid , c.attrvalue,
		c.attrname FROM
		bsp_productskus a,
		bsp_products b, bsp_attributevalues c
		where a.skugid
		= b.skugid
		and
		b.skugid = #{skugid,jdbcType=INTEGER}
		and
		a.attrvalueid =
		c.attrvalueid
		order
		by attrid;
	</select>



	<select id="getBrandSkuByAreaId" resultMap="skumap"
		parameterType="java.lang.Integer">

		SELECT a.*, d.attrvalue, d.attrname FROM bsp_productskus
		a,
		bsp_productsregionsbrand b,
		bsp_productsregions c,
		bsp_attributevalues
		d
		where a.attrvalueid = b.brandId
		and d.attrvalueid =
		a.attrvalueid
		and b.productregionsId = c.id
		and
		c.RegionsId =
		#{areaId,jdbcType=INTEGER};

	</select>

	<select id="getFactorySkuByBrand" resultMap="skumap"
		parameterType="java.lang.Integer">
		SELECT a.* FROM bsp_productskus a,
		bsp_productsregionsbrandplace b,
		bsp_productsregions c
		where
		a.attrvalueid = b.placeId
		and b.brandId = #{brandId,jdbcType=INTEGER}
		and b.productregionsId = c.id
		and c.RegionsId =
		#{areaId,jdbcType=INTEGER};
	</select>







	<select id="getProductSkuList" resultMap="skumap" parameterType="java.lang.Integer">

		SELECT temp1.recordid
		,temp1.skugid
		,temp1.pid
		,temp1.attrid
		,temp1.attrvalueid
		,temp1.inputvalue
		,temp2.attrvalue
		,temp2.isinput
		,temp2.attrname
		,temp2.attrshowtype
		,temp3.showimg
		FROM (SELECT
		recordid,skugid,pid,attrid,attrvalueid,inputvalue FROM
		bsp_productskus
		WHERE skugid=#{pid,jdbcType=INTEGER}) AS temp1
		LEFT JOIN
		bsp_attributevalues AS temp2
		ON temp1.attrvalueid=temp2.attrvalueid
		LEFT JOIN bsp_products AS temp3
		ON temp1.pid=temp3.pid
		ORDER BY
		temp2.attrdisplayorder DESC,temp2.attrvaluedisplayorder DESC
	</select>




	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		select
		<include refid="Base_Column_List" />
		from bsp_productskus
		where recordid = #{recordid,jdbcType=INTEGER}
	</select>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		delete from bsp_productskus
		where recordid =
		#{recordid,jdbcType=INTEGER}
	</delete>
	<delete id="deleteByExample" parameterType="com.runlion.shop.entity.BspProductskusExample">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		delete from bsp_productskus
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
	</delete>
	<insert id="insert" parameterType="com.runlion.shop.entity.BspProductskus">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		insert into bsp_productskus (recordid, skugid, pid,
		attrid,
		attrvalueid, inputvalue
		)
		values (#{recordid,jdbcType=INTEGER},
		#{skugid,jdbcType=INTEGER},
		#{pid,jdbcType=INTEGER},
		#{attrid,jdbcType=SMALLINT}, #{attrvalueid,jdbcType=INTEGER},
		#{inputvalue,jdbcType=VARCHAR}
		)
	</insert>
	<insert id="insertSelective" parameterType="com.runlion.shop.entity.BspProductskus">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		insert into bsp_productskus
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="recordid != null">
				recordid,
			</if>
			<if test="skugid != null">
				skugid,
			</if>
			<if test="pid != null">
				pid,
			</if>
			<if test="attrid != null">
				attrid,
			</if>
			<if test="attrvalueid != null">
				attrvalueid,
			</if>
			<if test="inputvalue != null">
				inputvalue,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="recordid != null">
				#{recordid,jdbcType=INTEGER},
			</if>
			<if test="skugid != null">
				#{skugid,jdbcType=INTEGER},
			</if>
			<if test="pid != null">
				#{pid,jdbcType=INTEGER},
			</if>
			<if test="attrid != null">
				#{attrid,jdbcType=SMALLINT},
			</if>
			<if test="attrvalueid != null">
				#{attrvalueid,jdbcType=INTEGER},
			</if>
			<if test="inputvalue != null">
				#{inputvalue,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>
	<select id="countByExample" parameterType="com.runlion.shop.entity.BspProductskusExample"
		resultType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		select count(*) from bsp_productskus
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
	</select>
	<update id="updateByExampleSelective" parameterType="map">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		update bsp_productskus
		<set>
			<if test="record.recordid != null">
				recordid = #{record.recordid,jdbcType=INTEGER},
			</if>
			<if test="record.skugid != null">
				skugid = #{record.skugid,jdbcType=INTEGER},
			</if>
			<if test="record.pid != null">
				pid = #{record.pid,jdbcType=INTEGER},
			</if>
			<if test="record.attrid != null">
				attrid = #{record.attrid,jdbcType=SMALLINT},
			</if>
			<if test="record.attrvalueid != null">
				attrvalueid = #{record.attrvalueid,jdbcType=INTEGER},
			</if>
			<if test="record.inputvalue != null">
				inputvalue = #{record.inputvalue,jdbcType=VARCHAR},
			</if>
		</set>
		<if test="_parameter != null">
			<include refid="Update_By_Example_Where_Clause" />
		</if>
	</update>
	<update id="updateByExample" parameterType="map">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		update bsp_productskus
		set recordid =
		#{record.recordid,jdbcType=INTEGER},
		skugid =
		#{record.skugid,jdbcType=INTEGER},
		pid =
		#{record.pid,jdbcType=INTEGER},
		attrid =
		#{record.attrid,jdbcType=SMALLINT},
		attrvalueid =
		#{record.attrvalueid,jdbcType=INTEGER},
		inputvalue =
		#{record.inputvalue,jdbcType=VARCHAR}
		<if test="_parameter != null">
			<include refid="Update_By_Example_Where_Clause" />
		</if>
	</update>
	<update id="updateByPrimaryKeySelective" parameterType="com.runlion.shop.entity.BspProductskus">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		update bsp_productskus
		<set>
			<if test="skugid != null">
				skugid = #{skugid,jdbcType=INTEGER},
			</if>
			<if test="pid != null">
				pid = #{pid,jdbcType=INTEGER},
			</if>
			<if test="attrid != null">
				attrid = #{attrid,jdbcType=SMALLINT},
			</if>
			<if test="attrvalueid != null">
				attrvalueid = #{attrvalueid,jdbcType=INTEGER},
			</if>
			<if test="inputvalue != null">
				inputvalue = #{inputvalue,jdbcType=VARCHAR},
			</if>
		</set>
		where recordid = #{recordid,jdbcType=INTEGER}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.runlion.shop.entity.BspProductskus">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Jun 26 
			14:56:27 CST 2015. -->
		update bsp_productskus
		set skugid = #{skugid,jdbcType=INTEGER},
		pid =
		#{pid,jdbcType=INTEGER},
		attrid = #{attrid,jdbcType=SMALLINT},
		attrvalueid = #{attrvalueid,jdbcType=INTEGER},
		inputvalue =
		#{inputvalue,jdbcType=VARCHAR}
		where recordid =
		#{recordid,jdbcType=INTEGER}
	</update>
</mapper>